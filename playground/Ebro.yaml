imports:
  docker:
    from: ./docker
    # generated:
    #   script: hoho

tasks:
  default:
    requires: [echoer, producer, docker]

  echoer:
    script: |
      cat cache/A.txt
      cat cache/B.txt

  producer:
    requires: [produce_a, produce_b]

  produce_a:
    requires: [cache_dir]
    required_by: [echoer]
    script: echo 'this is A'>cache/A.txt
    skip_if: test -f cache/A.txt

  produce_b:
    requires: [cache_dir]
    required_by: [echoer]
    script: echo 'this is B'>cache/B.txt
    skip_if: test -f cache/B.txt

  cache_dir:
    script: mkdir -p cache
    skip_if: test -d cache

  other_branch:
    requires: [other_subtask]

  other_subtask:
    script: echo hello
